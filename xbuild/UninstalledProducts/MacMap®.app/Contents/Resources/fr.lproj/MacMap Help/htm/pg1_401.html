<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>XMap Sélectionner</title>
<link rel="stylesheet" href="../css/style.css">
<meta name="AppleTitle" content="Aide MacMap®">
<meta name="AppleIcon" content="MacMap Help/img/MacMapIcon.png">
<meta name="keywords" content="Sélectionner">
</head>
<body>
<a name=pg1_401>
</a>
<table class="switch" width=100%>
<tr>
<td align="left">
<a href="help:anchor='pg0_3' bookID=Aide MacMap®">Index Menu</a>
</td>
<td align="right">
<a href="help:anchor='pg0_4' bookID=Aide MacMap®">Index Alphabétique</a>
</td>
</tr>
</table>
<br>
<table border=0 cellspacing=0 cellspacing=0 width=100%>
<tr>
<td class="item">
XMap Sélectionner
</td>
</tr>
<tr>
<td>
<p>
Permet d'éditer une requête multicritères. La fenêtre "sélectionner" se décompose en trois onglets:<br>
<b>Critères</b>
<br>
ce premier onglet permet de spécifier le type d'objets sur lesquels portera la requête, ainsi que les critères alphanumériques. Un critère de recherche est composé de trois éléments : un champ ou une <a href="pg1_607.html">calc</a> cible, un opérateur et une valeur. Une fois le critère déterminé, un clic sur le bouton "+" permet de l'ajouter à la liste des critères. Le bouton "-" permet de supprimer un critère. La case à cocher "Question ouverte" permet de provoquer une demande de valeur à chaque exécution de la requête (utile dans le cadre des macros).<br>
<b>Relations</b>
<br>
Ce sont les relations (Geogs pour relations géographiques) entre les objets. Il est ainsi possible de sélectionner les objets du type spécifié contenus dans une liste d'objets surfaciques sélectionnés ou contrastés. Les geogs disponibles sont :<br>
<a href="pg5_101.html">A moins de</a>
<br>
<a href="pg5_102.html">A plus de</a>
<br>
<a href="pg5_103.html">Dedans</a>
<br>
<a href="pg5_104.html">Dehors</a>
<br>
<a href="pg5_105.html">Englobant</a>
<br>
<a href="pg5_106.html">Le long</a>
<br>
<a href="pg5_107.html">Au tenant</a>
<br>
<a href="pg5_108.html">A l'aboutissant</a>
<br>
<a href="pg5_109.html">Les plus proches</a>
<br>
<a href="pg5_110.html">Les plus éloignés</a>
<br>
<a href="pg5_111.html">Partant de</a>
<br>
<a href="pg5_112.html">Arrivant à</a>
<br>
<b>Options</b>
<br>
Les options permettent d'appliquer des traitements particuliers : remplacer la sélection existante par la nouvelle, ajouter la nouvelle sélection à l'existante, soustraires les objets sélectionnés d'une sélection existante, et prendre en compte les objets masqués.<br>
Il est également possible de provoquer le contraste ou le masquage des objets sélectionnés, ou au contraire, des objets non sélectionnés.<br>
Enfin, on peut également choisir une macro qui sera exécutée automatiquement à la suite de la sélection initiale.<br>
Le bouton "Enregistrer", visible lors d'un appel à partir de la boîte "Macros", permet de stocker la requête. Elle est ensuite accessible sous forme de macro.
</p>
</td>
</tr>

<tr>
<td class="scripttitle">
Commande script
</td>
</tr>
<tr>
<td class="scriptitem">
<pre class="scriptitem">
&lt;selector&gt;
    &lt;formula&gt;
        &lt;dbtype&gt;<i class=varitem>Nom du type</i>&lt;/dbtype&gt;
        &lt;dbselkind&gt;<i class=varitem>Type de sélection (1=Remplacer, 2=Ajouter, 3=Soustraire)</i>&lt;/dbselkind&gt;
        &lt;dbusemasked&gt;<i class=varitem>Prendre en compte les objets masqués (0 ou 1)</i>&lt;/dbusemasked&gt;
        &lt;dbaddtocontrast&gt;<i class=varitem>Ajouter la sélection aux contrastes (0 ou 1)</i>&lt;/dbaddtocontrast&gt;
        &lt;dbaddtomasked&gt;<i class=varitem>Masquer la sélection (0=Ne pas Masquer, 1=Ceux-ci, 2=Les autres)</i>&lt;/dbaddtomasked&gt;
        &lt;dbsetnext&gt;<i class=varitem>Optionnel, Identifiant d'une Macro, sur 4 caractères.</i>&lt;/dbsetnext&gt;
        &lt;!--Exemple de Geog (Optionnelle)--&gt;
        &lt;lessthan&gt;<i class=varitem>A moins de : distance de recherche des objets</i>&lt;/lessthan&gt;
        &lt;!--Exemple de formule--&gt;
        &lt;and&gt;<i class=varitem>!--ou : or--</i>&lt;/and&gt;
            &lt;equal&gt;<i class=varitem>!--ou : higher, higherorequal, lower, lowerorequal, notequal, beginwith, endwith, contain--</i>&lt;/equal&gt;
                &lt;dbfield&gt;<i class=varitem>Nom du champ</i>&lt;/dbfield&gt;
                &lt;dbint&gt;<i class=varitem>Valeur (dbfloat, dbchar, dbbool, dbdate, dbtime, dbquestion). Il est possible de passer ici une constante, par exemple fvarnow (maintenant). Pour les constantes utilisateur, utiliser fvaruser et passer l'identifiant de constante en paramètre</i>&lt;/dbint&gt;
            &lt;/equal&gt;
            &lt;lowerorequal&gt;
                &lt;fcalcarea&gt;<i class=varitem>!--Surface. Pour les calcs utilisateur, utiliser fcalcuser et passer l'identifiant de calc en paramètre--</i>&lt;/fcalcarea&gt;
                &lt;dbfloat&gt;<i class=varitem>Valeur de la surface</i>&lt;/dbfloat&gt;
            &lt;/lowerorequal&gt;
        &lt;/and&gt;
    &lt;/formula&gt;
&lt;/selector&gt;
</pre>
</td>
</tr>


</table>
</body>
</html>
